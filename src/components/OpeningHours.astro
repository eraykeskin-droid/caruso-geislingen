---
const defaultDays = [
    { name: "Montag", hours: "18:00 - 00:00 Uhr" },
    { name: "Dienstag", hours: "18:00 - 00:00 Uhr" },
    { name: "Mittwoch", hours: "18:00 - 00:00 Uhr" },
    { name: "Donnerstag", hours: "18:00 - 00:00 Uhr" },
    { name: "Freitag", hours: "18:00 - 03:00 Uhr" },
    { name: "Samstag", hours: "14:00 - 03:00 Uhr" },
    { name: "Sonntag", hours: "14:00 - 00:00 Uhr" },
];
---

<div
    class="opening-hours-container w-full flex-1 bg-white/[0.02] border border-white/5 p-8 rounded-none"
>
    <div id="opening-hours-list" class="divide-y divide-white/5">
        <!-- Rendered by client script -->
    </div>
</div>

<script define:vars={{ defaultDays }}>
    const container = document.getElementById("opening-hours-list");

    async function loadOpeningHours() {
        if (!container) return;

        try {
            const res = await fetch(
                "/api/get-website-data.php?t=" + Date.now()
            );
            const data = await res.json();
            const days = data.success && data.days ? data.days : defaultDays;
            renderDays(days);
        } catch (err) {
            console.error("Error loading opening hours:", err);
            renderDays(defaultDays);
        }
    }

    function renderDays(days) {
        const todayIndex = (new Date().getDay() + 6) % 7;
        container.innerHTML = days
            .map((day, index) => {
                const isToday = index === todayIndex;
                return `
                <div class="flex justify-between items-center py-3 px-4 rounded-none transition-all duration-300 ${
                    isToday
                        ? "bg-secondary text-black font-bold scale-[1.02] shadow-[0_0_20px_rgba(255,224,138,0.2)]"
                        : "text-gray-400"
                }">
                    <span class="text-xs uppercase tracking-widest flex items-center gap-2">
                        ${
                            isToday
                                ? '<span class="w-1.5 h-1.5 bg-black rounded-none animate-pulse"></span>'
                                : ""
                        }
                        ${day.name}
                    </span>
                    <span class="text-xs ${
                        isToday ? "text-black" : "text-gray-500"
                    }">
                        ${day.hours}
                    </span>
                </div>`;
            })
            .join("");
    }

    loadOpeningHours();
</script>
